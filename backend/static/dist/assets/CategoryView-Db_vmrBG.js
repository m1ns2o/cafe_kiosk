import{d as O,r,c as z,x as $,o as Q,C as g,a as X,b as i,e as t,w as l,f as s,F as Y,E as _,g as E,y as Z,z as ee,i as ae,j as x,A as te,B as le,m as w,D as oe,G as ne,H as se,_ as re}from"./index-AdcA_jBz.js";const ie={class:"category-container"},ce={class:"category-content"},de={class:"card-header"},ue={class:"action-buttons"},me={class:"pagination-container"},fe={class:"dialog-footer"},pe=O({__name:"CategoryView",setup(ge){const v=(a,e)=>{console.error(e,a);let u=e;a.response&&a.response.data&&a.response.data.message&&(u+=`: ${a.response.data.message}`),_.error(u)},F=r(),k=r([]),m=r(!1),y=r(!1),p=r(1),b=r(8),V=z(()=>k.value),T=z(()=>{const a=(p.value-1)*b.value,e=a+b.value;return V.value.slice(a,e)}),c=r(!1),d=r("add"),f=r(),o=$({id:0,name:""}),A=$({name:[{required:!0,message:"카테고리 이름을 입력해주세요",trigger:"blur"},{min:1,max:50,message:"카테고리 이름은 1-50자 이내로 입력해주세요",trigger:"blur"}]});Q(async()=>{await h()});const h=async()=>{m.value=!0;try{const a=await g.getAllCategories();a&&a.data&&(k.value=a.data)}catch(a){v(a,"카테고리 데이터를 불러오는 중 오류가 발생했습니다")}finally{m.value=!1}},I=a=>{p.value=a},M=()=>{d.value="add",D(),c.value=!0},R=(a,e)=>{d.value="edit",o.id=e.id,o.name=e.name,c.value=!0},D=()=>{f.value&&f.value.resetFields(),o.id=0,o.name=""},S=async()=>{f.value&&await f.value.validate(async a=>{if(a){y.value=!0;try{d.value==="add"?(await g.createCategory(o.name),_.success("카테고리가 추가되었습니다.")):(await g.updateCategory(o.id,o.name),_.success("카테고리가 수정되었습니다.")),c.value=!1,await h()}catch(e){v(e,`카테고리를 ${d.value==="add"?"추가":"수정"}하는 중 오류가 발생했습니다`)}finally{y.value=!1}}})},N=a=>{se.confirm(`"${a.name}" 카테고리를 삭제하시겠습니까?`,"삭제 확인",{confirmButtonText:"삭제",cancelButtonText:"취소",type:"warning"}).then(()=>{P(a.id)}).catch(()=>{})},P=async a=>{m.value=!0;try{await g.deleteCategory(a),_.success("카테고리가 삭제되었습니다."),await h()}catch(e){v(e,"카테고리 삭제 중 오류가 발생했습니다")}finally{m.value=!1}};return(a,e)=>{const u=s("el-icon"),C=s("el-button"),B=s("el-table-column"),U=s("el-table"),j=s("el-pagination"),q=s("el-card"),G=s("el-input"),H=s("el-form-item"),L=s("el-form"),W=s("el-dialog"),J=ee("loading");return E(),X(Y,null,[i("div",ie,[i("div",ce,[t(q,{shadow:"hover",class:"category-card"},{header:l(()=>[i("div",de,[e[5]||(e[5]=i("span",{class:"header-title"},"카테고리 관리",-1)),t(C,{type:"primary",size:"small",onClick:M,class:"add-button"},{default:l(()=>[t(u,{class:"el-icon--left",style:{color:"white"}},{default:l(()=>[t(x(oe))]),_:1}),e[4]||(e[4]=w(" 항목 추가 "))]),_:1})])]),default:l(()=>[Z((E(),ae(U,{ref_key:"tableRef",ref:F,"row-key":"id",data:T.value,"header-cell-class-name":"table-header",class:"category-table","header-cell-style":{fontSize:"16px",fontWeight:"bold",background:"#f5f7fa",height:"50px"},"cell-style":{fontSize:"15px",height:"60px"}},{default:l(()=>[t(B,{prop:"name",label:"카테고리","class-name":"name-column",align:"left"}),t(B,{label:"","class-name":"action-column",align:"right"},{default:l(n=>[i("div",ue,[t(u,{class:"action-icon edit-icon",onClick:K=>R(n.$index,n.row)},{default:l(()=>[t(x(te))]),_:2},1032,["onClick"]),t(u,{class:"action-icon delete-icon",onClick:K=>N(n.row)},{default:l(()=>[t(x(le))]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[J,m.value]]),i("div",me,[t(j,{"current-page":p.value,"onUpdate:currentPage":e[0]||(e[0]=n=>p.value=n),"page-size":b.value,layout:"total, prev, pager, next",total:V.value.length,onCurrentChange:I,"pager-count":5,background:""},null,8,["current-page","page-size","total"])])]),_:1})])]),t(W,{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=n=>c.value=n),title:d.value==="add"?"카테고리 추가":"카테고리 편집",width:"30%","close-on-click-modal":!1,onClose:D},{footer:l(()=>[i("span",fe,[t(C,{onClick:e[2]||(e[2]=n=>c.value=!1)},{default:l(()=>e[6]||(e[6]=[w("취소")])),_:1}),t(C,{type:"primary",onClick:S,loading:y.value},{default:l(()=>[w(ne(d.value==="add"?"추가":"저장"),1)]),_:1},8,["loading"])])]),default:l(()=>[t(L,{ref_key:"formRef",ref:f,model:o,rules:A,"label-width":"100px","label-position":"top"},{default:l(()=>[t(H,{label:"카테고리 이름",prop:"name"},{default:l(()=>[t(G,{modelValue:o.name,"onUpdate:modelValue":e[1]||(e[1]=n=>o.name=n),placeholder:"카테고리 이름을 입력하세요",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}}),ve=re(pe,[["__scopeId","data-v-51cddee8"]]);export{ve as default};
